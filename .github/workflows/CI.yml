name: My Test Workflow

on: 
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
    
jobs: 
  ci:
    runs-on: ubuntu-latest
    steps: 
      - name: Checkout
        uses: actions/checkout@v3

      - name: Use Node.js 
        uses: actions/setup-node@v3
        with: 
          node-version: '16.x'
          
      - name: Install npm 
        run: npm install

      - name: Run Lint
        run: npm run lint
        continue-on-error: false

      - name: Upload static files as artifact
        id: deployment
        uses: actions/upload-pages-artifact@v3 # or specific "vX.X.X" version tag for this action
        with:
          path: build_outputs_folder/

      #- name: Run Tests
        #run: |
          #cd src/tests
          #ls
          #npm run report-test
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: ci
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4

        
  cd:
      needs: ci
      runs-on: ubuntu-latest
      steps: 
      - name: Checkout
        uses: actions/checkout@v3
        
      - name: Use Node.js 
        uses: actions/setup-node@v4
        with: 
          node-version: '16.x'

      - name: Install npm 
        run: npm install

      - name: Run Build
        run: npm run build

      - name: Deploy to GitHub
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets }}
          publish_dir: dist
          

